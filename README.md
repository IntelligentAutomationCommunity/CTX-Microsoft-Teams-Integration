[![](https://img.shields.io/badge/Cortex-LivePortal-ff6600?logo=data:image/png;base64,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)](https://www.cortex-ia.com/our-software) 
[![](https://img.shields.io/badge/LinkedIn-Cortex-blue.svg?logo=linkedin)](https://www.linkedin.com/company/cortex-intelligent-automation-software/)
[![](https://img.shields.io/badge/Cortex-Blog-a0c326?logo=data:image/png;base64,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)](https://www.cortex-ia.com/latest-news-at-cortex/)

# CTX-Microsoft-Teams-Integration

The Cortex Microsoft Teams integration module allows you to create information and action cards in Microsoft Teams. More information regarding the cards layout can be found in: *[message card reference](https://docs.microsoft.com/en-us/outlook/actionable-messages/message-card-reference)*

# How to use intructions

## Architecture

To be able to integrate Cortex with Microsoft Teams there a few key configurations required:
* Webhook needs to be created in Microsoft Teams (*[Microsfot Teams Incoming Webhooks](https://docs.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook)*)
* IIS application needs to be created (example: \TeamsInterface)
  * Application should route all requests into the Cortex Flow API URL
  * Application should add the Cortex Flow API authentication header
  * A trusted SSL certificate needs to be used (Microsoft Teams does not support self signed certificates)
    * You can use a free service to generate a trusted SSL certificate
* Cortex server requires connectivity to Microsoft Teams webhook URL

&nbsp;&nbsp;![image](https://user-images.githubusercontent.com/79215180/110451627-47b23380-80bc-11eb-82d6-69a8c2c8afc9.png)


## Use cases
The following use cases drove the requirements for the implemented functionality.
### Informative message posted to Microsoft Teams

&nbsp;&nbsp;![image](https://user-images.githubusercontent.com/79215180/110444239-affd1700-80b4-11eb-9e31-213626b56075.png)

**Requirements:**
* Create card with
  * Single section
  * Title
  * Section Title, Subtitle and Image
  * Section Facts
  * Text

* Example

&nbsp;&nbsp;![image](https://user-images.githubusercontent.com/79215180/110445466-09197a80-80b6-11eb-9cc8-de15073c271c.png)


### Action message posted to Microsoft Teams

&nbsp;&nbsp;![image](https://user-images.githubusercontent.com/79215180/110444269-b8ede880-80b4-11eb-9d3e-436e41bf3ed6.png)

**Requirements:**
* Create card as an the informative card with:
  * Actions with buttons
    * HTTP Button
    * HTTP Button with Text
    * HTTP Button with Multiple Choice
    * HTTP Button with Date Choice
    * These buttons will send an HTTP rest request

* Example

&nbsp;&nbsp;![image](https://user-images.githubusercontent.com/79215180/110446270-e471d280-80b6-11eb-939f-9ec78bc371ff.png)

## Implemented functionality

The following subtasks were implemented:
* Teams-Create-Action-HTTP-Button
* Teams-Create-Action-HTTP-Button-With-Text-Input
* Teams-Create-Action-HTTP-Button-With-Multiple-Choice-Input
* Teams-Create-Action-HTTP-Button-with-Date-Input
* Teams-Create-Action-Open-URI-Button


The following flows were implemented:
* Teams-Incoming-Request-Parser
  * Used as a generic flow to parser the requests coming from the Microsoft Teams Webhook
* Teams-Request-Monthly-Report-Approval:
  * This flow sends an action card with 2 buttons where one requires text input
  * Example below:
  &nbsp;&nbsp;![image](https://user-images.githubusercontent.com/79215180/110451219-e25e4280-80bb-11eb-9fb2-16f94657a819.png)






